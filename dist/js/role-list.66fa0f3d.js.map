{"version":3,"sources":["webpack:///./src/api/permission.js","webpack:///./src/api/role.js","webpack:///./src/views/role-list/components/DistributePermission.vue","webpack:///./src/views/role-list/components/DistributePermission.vue?2e3e","webpack:///./src/views/role-list/index.vue","webpack:///./src/views/role-list/index.vue?2fc1"],"names":["permissionList","request","url","roleList","rolePermission","roleId","distributePermission","data","method","allPermission","getPermissionList","permission","value","defaultProps","children","label","treeRef","getRolePermission","role","props","checkedKeys","setCheckedKeys","val","i18n","onConfirm","permissions","getCheckedKeys","success","t","closed","emits","__exports__","allRoles","getRoleList","distributePermissionVisible","selectRoleId","onDistributePermissionClick","row","id"],"mappings":"6GAAA,kDAKaA,EAAiB,WAC5B,OAAOC,eAAQ,CACbC,IAAK,uB,kCCPT,sHAKaC,EAAW,WACtB,OAAOF,eAAQ,CACbC,IAAK,gBAOIE,EAAiB,SAAAC,GAC5B,OAAOJ,eAAQ,CACbC,IAAK,oBAAF,OAAsBG,MAOhBC,EAAuB,SAAAC,GAClC,OAAON,eAAQ,CACbC,IAAK,8BACLM,OAAQ,OACRD,W,wTCCU,EAqBRE,EAAgB,iBAAI,IACpBC,EAAiB,yDAAG,8GACI,OAAAC,EAAA,QADJ,OACxBF,EAAcG,MADU,kDAAH,qDAGvBF,IACA,eAAgBA,GAGhB,IAAMG,EAAe,CACnBC,SAAU,WACVC,MAAO,kBAIHC,EAAU,iBAAI,MAGdC,EAAiB,yDAAG,oHACE,OAAAC,EAAA,MAAeC,EAAMd,QADvB,OAClBe,EADkB,OAExBJ,EAAQJ,MAAMS,eAAeD,GAFL,2CAAH,qDAKvB,oBACE,kBAAMD,EAAMd,UACZ,SAAAiB,GACMA,GAAKL,OAOb,IAAMM,EAAO,iBACPC,EAAS,yDAAG,8GACV,eAAqB,CACzBnB,OAAQc,EAAMd,OACdoB,YAAaT,EAAQJ,MAAMc,mBAHb,OAKhB,OAAUC,QAAQJ,EAAKK,EAAE,+BACzBC,IANgB,2CAAH,qDAYTA,EAAS,WACbC,EAAM,qBAAqB,I,uiCC5F7B,MAAMC,EAAc,EAEL,Q,kCCoCf,IAAMC,EAAW,iBAAI,IACfC,EAAW,yDAAG,8GACK,OAAAf,EAAA,QADL,OAClBc,EAASpB,MADS,kDAAH,qDAGjBqB,IACA,eAAgBA,GAKhB,IAAMC,EAA8B,kBAAI,GAClCC,EAAe,iBAAI,IACnBC,EAA8B,SAAAC,GAClCF,EAAavB,MAAQyB,EAAIC,GACzBJ,EAA4BtB,OAAQ,G,y9CCpDtC,MAAM,EAAc,EAEL","file":"js/role-list.66fa0f3d.js","sourcesContent":["import request from '@/utils/request'\n\n/**\n * 获取所有权限\n */\nexport const permissionList = () => {\n  return request({\n    url: '/permission/list'\n  })\n}\n","import request from '@/utils/request'\n\n/**\n * 获取所有角色\n */\nexport const roleList = () => {\n  return request({\n    url: '/role/list'\n  })\n}\n\n/**\n * 获取指定角色的权限\n */\nexport const rolePermission = roleId => {\n  return request({\n    url: `/role/permission/${roleId}`\n  })\n}\n\n/**\n * 为角色修改权限\n */\nexport const distributePermission = data => {\n  return request({\n    url: '/role/distribute-permission',\n    method: 'POST',\n    data\n  })\n}\n","<template>\n  <el-dialog\n    :title=\"$t('msg.excel.roleDialogTitle')\"\n    :model-value=\"modelValue\"\n    @close=\"closed\"\n  >\n    <el-tree\n      ref=\"treeRef\"\n      :data=\"allPermission\"\n      show-checkbox\n      check-strictly\n      node-key=\"id\"\n      default-expand-all\n      :props=\"defaultProps\"\n    >\n    </el-tree>\n\n    <template #footer>\n      <span class=\"dialog-footer\">\n        <el-button @click=\"closed\">{{ $t('msg.universal.cancel') }}</el-button>\n        <el-button type=\"primary\" @click=\"onConfirm\">{{\n          $t('msg.universal.confirm')\n        }}</el-button>\n      </span>\n    </template>\n  </el-dialog>\n</template>\n\n<script setup>\nimport { defineProps, defineEmits, ref, watch } from 'vue'\nimport { permissionList } from '@/api/permission'\nimport { watchSwitchLang } from '@/utils/i18n'\nimport { rolePermission, distributePermission } from '@/api/role'\nimport { useI18n } from 'vue-i18n'\nimport { ElMessage } from 'element-plus'\n\nconst props = defineProps({\n  modelValue: {\n    type: Boolean,\n    required: true\n  },\n  roleId: {\n    type: String,\n    required: true\n  }\n})\nconst emits = defineEmits(['update:modelValue'])\n\n// 所有权限\nconst allPermission = ref([])\nconst getPermissionList = async () => {\n  allPermission.value = await permissionList()\n}\ngetPermissionList()\nwatchSwitchLang(getPermissionList)\n\n// 属性结构配置\nconst defaultProps = {\n  children: 'children',\n  label: 'permissionName'\n}\n\n// tree 节点\nconst treeRef = ref(null)\n\n// 获取当前用户角色的权限\nconst getRolePermission = async () => {\n  const checkedKeys = await rolePermission(props.roleId)\n  treeRef.value.setCheckedKeys(checkedKeys)\n}\n\nwatch(\n  () => props.roleId,\n  val => {\n    if (val) getRolePermission()\n  }\n)\n\n/**\n  确定按钮点击事件\n */\nconst i18n = useI18n()\nconst onConfirm = async () => {\n  await distributePermission({\n    roleId: props.roleId,\n    permissions: treeRef.value.getCheckedKeys()\n  })\n  ElMessage.success(i18n.t('msg.role.updateRoleSuccess'))\n  closed()\n}\n\n/**\n * 关闭\n */\nconst closed = () => {\n  emits('update:modelValue', false)\n}\n</script>\n\n<style lang=\"scss\" scoped></style>\n","import script from \"./DistributePermission.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./DistributePermission.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\n  <div class=\"\">\n    <el-card>\n      <el-table :data=\"allRoles\" border style=\"width: 100%\">\n        <el-table-column :label=\"$t('msg.role.index')\" type=\"index\" width=\"120\">\n        </el-table-column>\n        <el-table-column :label=\"$t('msg.role.name')\" prop=\"title\">\n        </el-table-column>\n        <el-table-column :label=\"$t('msg.role.desc')\" prop=\"describe\">\n        </el-table-column>\n        <el-table-column\n          :label=\"$t('msg.role.action')\"\n          prop=\"action\"\n          width=\"260\"\n          #default=\"{ row }\"\n        >\n          <el-button\n            type=\"primary\"\n            size=\"mini\"\n            @click=\"onDistributePermissionClick(row)\"\n            v-permission=\"['distributePermission']\"\n          >\n            {{ $t('msg.role.assignPermissions') }}\n          </el-button>\n        </el-table-column>\n      </el-table>\n    </el-card>\n\n    <distribute-permission\n      v-model=\"distributePermissionVisible\"\n      :roleId=\"selectRoleId\"\n    ></distribute-permission>\n  </div>\n</template>\n\n<script setup>\nimport { roleList } from '@/api/role'\nimport { watchSwitchLang } from '@/utils/i18n'\nimport { ref } from 'vue'\nimport DistributePermission from './components/DistributePermission.vue'\n\nconst allRoles = ref([])\nconst getRoleList = async () => {\n  allRoles.value = await roleList()\n}\ngetRoleList()\nwatchSwitchLang(getRoleList)\n\n/**\n * 分配权限\n */\nconst distributePermissionVisible = ref(false)\nconst selectRoleId = ref('')\nconst onDistributePermissionClick = row => {\n  selectRoleId.value = row.id\n  distributePermissionVisible.value = true\n}\n</script>\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"sourceRoot":""}